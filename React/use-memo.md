# useMemo の使い方

## 参考
- https://ja.react.dev/reference/react/useMemo

## useMemo とは
- **メモ化された値を返す** React のフック
- 高コストな計算を必要とする処理や関数の実行結果をメモ化し、**再レンダー時の不要な再計算を防ぐ**ことでパフォーマンスを最適化する

## 基本的な使い方
```jsx
const memoizedValue = useMemo(() => {
  // コストの高い計算など
  return someExpensiveCalculation(params);
}, [params]);
```
- 第1引数：メモ化したい処理(関数)
- 第2引数：依存配列(配列内の値が変化したときのみ再計算)

## メリット
1. **パフォーマンス向上**  
   - 高コストな演算や頻繁に変わらない値をメモ化することで、不要な再計算を回避できる
2. **再レンダーの負荷軽減**  
   - Reactコンポーネントの再レンダーが発生しても、依存配列の値が変わらない限りメモ化された値をそのまま利用する

## 注意点
1. **常にメリットがあるわけではない**  
   - メモ化自体にもオーバーヘッド(メモリ使用や依存関係の比較)があるため、低コストな処理には使わない方が良い場合もある
2. **依存配列の設定ミスに注意**  
   - 正しく指定しないとメモ化の結果が古い値のままになったり、再計算が意図せず頻発したりする可能性がある
3. **`useMemo` と `memo` の区別**  
   - `useMemo` は “値” のメモ化  
   - `memo`(コンポーネント) は “コンポーネント自体” のメモ化

## よくある誤解
- **「useMemo = 関数コンポーネント版 shouldComponentUpdate」ではない**  
  - `useMemo` はあくまで "演算結果のメモ化" を行うフック。コンポーネントの再レンダー可否を直接制御するものではない
- **一度使えば常に早くなるわけではない**  
  - コストの大きい処理や再計算を頻繁に行う部分でのみ効果的

## 使いどころの例
- **配列のソートやフィルタリング**  
  - 大きな配列からフィルタやソートを行う際にメモ化しておくと効率的
- **複雑な計算ロジック**  
  - 計算ロジックが重い場合に、依存するパラメータが変わらないときは再計算をスキップ可能

---

### まとめ
- `useMemo` は複雑・高コストな計算が頻繁に発生する場面でのみ有効  
- 依存配列を正しく設定し、不要な再計算を防ぐ  
- メモ化のオーバーヘッドを考慮し、必要な場面にのみ使用すること
